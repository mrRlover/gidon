<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Main Research Tests</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css\styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Honours R Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-info"></span>
     
    Data Import
  </a>
</li>
<li>
  <a href="data-setup.html">
    <span class="fa fa-exchange-alt"></span>
     
    Data Setup
  </a>
</li>
<li>
  <a href="sorts.html">
    <span class="fa fa-sort-amount-up"></span>
     
    Portfolio Sorts
  </a>
</li>
<li>
  <a href="tests.html">
    <span class="fa fa-calculator"></span>
     
    Tests
  </a>
</li>
<li>
  <a href="diagnostics.html">
    <span class="fa fa-diagnoses"></span>
     
    Diagnostics
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Main Research Tests</h1>

</div>


<p>In the final section, we test to see if the returns of the portfolios are statistically significant. In other words, are the returns significant even after adjusting for risk as measured by the capm?</p>
<p>To test this, we first need to find portfolio betas.</p>
<pre class="r"><code>allRegData &lt;- data.frame(sweep(coredata(r.xts), 1, coredata(rfr)), RM = coredata(jalsh) - coredata(rfr))[-1,]

betas &lt;- matrix(NA, nrow = nrow(r.xts)-12, ncol = ncol(r.xts))

for (i in 1:ncol(betas)) {
  betas[,i] &lt;- rollapply(zoo(allRegData[,c(i, 6)]),
                         width=12,
                         FUN = function(Z) 
                         { 
                           t = lm(formula=Z[,1]~RM, data = as.data.frame(Z), na.rm=T); 
                           return(t$coef) 
                         },
                         by.column=FALSE, align=&quot;right&quot;)[,2, drop = FALSE]
}</code></pre>
<p>The code above creates rolling 12 month betas for each of the portfolios. First we define a data frame that holds our data. The dataframe contains return premiums of the portfolios and of the market. Then we iterate over each column in the dataframe to calculate rolling betas.</p>
<p>To test the return significance of the portfolios, we regress the monthly returns on the portfolio betas. If the returns from the portfolios are commensurate with the risk (i.e beta) of the portfolio, then the intercept term should not be statistically significant.</p>
<pre class="r"><code>alphas &lt;- lapply(r.xts[-c(1:12)], function(x, d) lm(x ~ d), betas)</code></pre>
<p>We use stargazer to report the results. We don’t print the initial stargazer output, as there are a couple of things that need changing. So to save the output <em>and</em> prevent the output from being printed to the console, we use <code>capture.output</code> to save the output quietly.</p>
<p>We then use <code>gsub()</code> to rename the labels of the high and low volatility portfolios, so that the result is clear. The second reason we save the stargazer output first is because we want to add a css class for additional styling. In this case, we want the table to fill the width of the container.</p>
<pre class="r"><code>stargazer(alphas$high, alphas$port2, alphas$port3, alphas$port4, alphas$low,  type = &quot;html&quot;, out = paste0(getwd(), &quot;/Output/results.html&quot;), summary = F, rownames = T, style = &quot;qje&quot; , omit = paste0(&quot;d&quot;, 1:5), dep.var.labels = colnames(r.xts))</code></pre>
<pre class="r"><code>output &lt;- capture.output(stargazer(alphas$high, alphas$port2, alphas$port3, alphas$port4, alphas$low,  type = &quot;html&quot;, out = paste0(getwd(), &quot;/Output/results.html&quot;), summary = F, rownames = T, style = &quot;qje&quot; , omit = paste0(&quot;d&quot;, 1:5), dep.var.labels = &quot;Volatility Portfolio&quot;))

output &lt;- gsub(&quot;\\(1\\)&quot;, &quot;high&quot;, output)
output &lt;- gsub(&quot;\\(5\\)&quot;, &quot;low&quot;, output)
output &lt;- gsub(&quot;&lt;table&quot;, &quot;&lt;table class = &#39;stargazer&#39;&quot;, output)
cat(output)</code></pre>
<table class="stargazer" style="text-align:center">
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5">
Volatility Portfolio
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
high
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
low
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.028
</td>
<td>
0.035<sup>**</sup>
</td>
<td>
0.036<sup>**</sup>
</td>
<td>
0.032<sup>***</sup>
</td>
<td>
0.022<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.027)
</td>
<td>
(0.017)
</td>
<td>
(0.014)
</td>
<td>
(0.012)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
<em>N</em>
</td>
<td>
217
</td>
<td>
217
</td>
<td>
217
</td>
<td>
217
</td>
<td>
217
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.022
</td>
<td>
0.018
</td>
<td>
0.027
</td>
<td>
0.026
</td>
<td>
0.016
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
-0.001
</td>
<td>
-0.006
</td>
<td>
0.003
</td>
<td>
0.003
</td>
<td>
-0.007
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 211)
</td>
<td>
0.077
</td>
<td>
0.047
</td>
<td>
0.039
</td>
<td>
0.034
</td>
<td>
0.027
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic (df = 5; 211)
</td>
<td>
0.939
</td>
<td>
0.755
</td>
<td>
1.150
</td>
<td>
1.110
</td>
<td>
0.686
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Notes:</em>
</td>
<td colspan="5" style="text-align:right">
<sup>***</sup>Significant at the 1 percent level.
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5" style="text-align:right">
<sup>**</sup>Significant at the 5 percent level.
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5" style="text-align:right">
<sup>*</sup>Significant at the 10 percent level.
</td>
</tr>
</table>
<p></br></p>
<p>As you can see from the results above, a high volatility portfolio does not produce statistically significant alphas, while the rest do. It is counterintuitive that portfolios with the lowest risk produce the most returns. Indeed, this a puzzle, which is at odds with the basic tenets of finance.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
